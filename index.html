<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>eFootball Quad-League</title>
    <style>
        :root {
            --ef-blue: #121f45;
            --ef-yellow: #f3c300;
            --ef-pink: #d9006c;
            --light: #f4f4f4;
            --success: #28a745;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--ef-blue);
            color: var(--light);
            margin: 0;
            padding: 10px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 20px;
            border-bottom: 3px solid var(--ef-yellow);
            padding-bottom: 10px;
        }

        h1 {
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--ef-yellow);
            font-size: 1.5rem;
        }
        
        p.subtitle { color: #ccc; font-size: 0.9rem; margin-top: 5px; }

        .card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        h2 {
            border-left: 5px solid var(--ef-pink);
            padding-left: 10px;
            margin-top: 0;
            font-size: 1.2rem;
        }

        /* Configuração dos Participantes */
        .players-setup {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }

        input[type="text"] {
            padding: 8px;
            border-radius: 5px;
            border: none;
            text-align: center;
            font-weight: bold;
            width: 22%; /* Ajustado para 4 jogadores */
            min-width: 120px;
        }

        /* Tabela */
        .table-responsive { overflow-x: auto; }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            color: #333;
            border-radius: 8px;
            font-size: 0.85rem;
            min-width: 600px;
        }

        th, td {
            padding: 8px;
            text-align: center;
            border-bottom: 1px solid #ddd;
        }

        th {
            background-color: var(--ef-yellow);
            color: var(--ef-blue);
            font-weight: 800;
        }

        tr:nth-child(even) { background-color: #f9f9f9; }

        tr:first-child td {
            font-weight: bold;
            background-color: rgba(243, 195, 0, 0.2);
            border-left: 5px solid var(--ef-pink);
        }

        /* Jogos */
        .round-header {
            background-color: var(--ef-blue);
            color: var(--ef-yellow);
            padding: 8px;
            text-align: center;
            font-weight: bold;
            border: 1px solid var(--ef-yellow);
            border-radius: 5px;
            margin-top: 15px;
            margin-bottom: 5px;
            text-transform: uppercase;
            font-size: 0.9rem;
        }

        .matches-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 10px;
        }

        .match {
            background: rgba(0,0,0,0.25);
            padding: 10px;
            border-radius: 5px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .match-main {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }

        .team-name {
            width: 35%;
            text-align: center;
            font-weight: bold;
            font-size: 0.85em;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .score-inputs {
            display: flex;
            align-items: center;
            gap: 5px;
            justify-content: center;
            width: 30%;
        }

        input[type="number"] {
            width: 35px;
            padding: 5px;
            text-align: center;
            font-size: 1.1em;
            border: 2px solid var(--ef-yellow);
            border-radius: 5px;
            background: #fff;
            color: #333;
        }

        /* Área de Pênaltis */
        .penalty-area {
            margin-top: 8px;
            background: rgba(217, 0, 108, 0.25);
            padding: 5px;
            border-radius: 4px;
            display: none;
            width: 100%;
            text-align: center;
        }

        .penalty-area.active { display: block; }

        .penalty-label {
            font-size: 0.75em;
            display: block;
            color: #ffb8da;
            margin-bottom: 3px;
        }

        .penalty-radios {
            display: flex;
            gap: 10px;
            justify-content: center;
            font-size: 0.8em;
        }

        label { cursor: pointer; display: flex; align-items: center; gap: 4px; }

        @media (max-width: 600px) {
            input[type="text"] { width: 45%; }
            .matches-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>eFootball Quad-League</h1>
        <p class="subtitle">4 Jogadores | 8 Turnos | Sem Empates</p>
    </header>

    <!-- Configuração de Nomes -->
    <div class="card">
        <h2>Participantes</h2>
        <div class="players-setup">
            <input type="text" id="p1-name" value="Jogador 1" oninput="updateNames()">
            <input type="text" id="p2-name" value="Jogador 2" oninput="updateNames()">
            <input type="text" id="p3-name" value="Jogador 3" oninput="updateNames()">
            <input type="text" id="p4-name" value="Jogador 4" oninput="updateNames()">
        </div>
    </div>

    <!-- Tabela de Classificação -->
    <div class="card">
        <h2>Classificação</h2>
        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Time</th>
                        <th>PTS</th>
                        <th>J</th>
                        <th>V</th>
                        <th>D</th>
                        <th>SG</th>
                        <th>GP</th>
                    </tr>
                </thead>
                <tbody id="standings-body">
                    <!-- Preenchido via JS -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Lista de Jogos -->
    <div class="card">
        <h2>Jogos (48 Total)</h2>
        <div id="matches-list">
            <!-- Gerado via JS -->
        </div>
    </div>
</div>

<script>
    // --- CONFIGURAÇÃO ---
    // Você pediu mais 4 turnos (além dos 4 anteriores). Total = 8.
    // Se quiser reduzir, mude este número aqui:
    const TOTAL_TURNS = 8; 

    // Dados dos jogadores (Agora 4)
    let players = [
        { id: 0, name: "Jogador 1" },
        { id: 1, name: "Jogador 2" },
        { id: 2, name: "Jogador 3" },
        { id: 3, name: "Jogador 4" }
    ];

    let schedule = [];

    function init() {
        generateSchedule();
        renderMatches();
        calculateTable();
    }

    // Gera a tabela de jogos para 4 pessoas
    function generateSchedule() {
        schedule = [];
        
        // Combinações para 4 jogadores (6 jogos por turno)
        // Todos contra todos
        const pairings = [
            { h: 0, a: 1 }, // 1x2
            { h: 2, a: 3 }, // 3x4
            { h: 0, a: 2 }, // 1x3
            { h: 1, a: 3 }, // 2x4
            { h: 0, a: 3 }, // 1x4
            { h: 1, a: 2 }  // 2x3
        ];

        for (let t = 1; t <= TOTAL_TURNS; t++) {
            pairings.forEach(pair => {
                // Inverte o mando nos turnos pares
                if (t % 2 === 0) {
                    schedule.push({ round: t, home: pair.a, away: pair.h, penWinner: null });
                } else {
                    schedule.push({ round: t, home: pair.h, away: pair.a, penWinner: null });
                }
            });
        }
    }

    function updateNames() {
        players[0].name = document.getElementById('p1-name').value;
        players[1].name = document.getElementById('p2-name').value;
        players[2].name = document.getElementById('p3-name').value;
        players[3].name = document.getElementById('p4-name').value;
        renderMatches(true); // true = mantém os placares
        calculateTable();
    }

    function renderMatches(preserveValues = false) {
        const container = document.getElementById('matches-list');
        
        let savedScores = {};
        let savedPens = {};
        if (preserveValues) {
            schedule.forEach((_, idx) => {
                const h = document.getElementById(`m${idx}_h`);
                const a = document.getElementById(`m${idx}_a`);
                if(h) savedScores[`m${idx}_h`] = h.value;
                if(a) savedScores[`m${idx}_a`] = a.value;
                const radios = document.getElementsByName(`pen_rad_${idx}`);
                radios.forEach(r => { if(r.checked) savedPens[idx] = r.value; });
            });
        }

        container.innerHTML = '';
        let currentRound = 0;
        let roundContainer = null;

        schedule.forEach((match, index) => {
            // Agrupamento por Turno
            if (match.round !== currentRound) {
                // Fecha grid anterior se existir
                if (roundContainer) container.appendChild(roundContainer);
                
                // Título do Turno
                container.innerHTML += `<div class="round-header">TURNO ${match.round}</div>`;
                
                // Cria novo container grid
                roundContainer = document.createElement('div');
                roundContainer.className = 'matches-grid';
                currentRound = match.round;
            }

            const homeName = players[match.home].name;
            const awayName = players[match.away].name;

            const html = `
                <div class="match" id="match-card-${index}">
                    <div class="match-main">
                        <span class="team-name" title="${homeName}">${homeName}</span>
                        <div class="score-inputs">
                            <input type="number" id="m${index}_h" oninput="handleScoreInput(${index})" min="0">
                            <span>x</span>
                            <input type="number" id="m${index}_a" oninput="handleScoreInput(${index})" min="0">
                        </div>
                        <span class="team-name" title="${awayName}">${awayName}</span>
                    </div>
                    
                    <div class="penalty-area" id="pen-area-${index}">
                        <span class="penalty-label">Pênaltis: Quem venceu?</span>
                        <div class="penalty-radios">
                            <label>
                                <input type="radio" name="pen_rad_${index}" value="${match.home}" onchange="handlePenInput(${index}, ${match.home})"> 
                                Casa
                            </label>
                            <label>
                                <input type="radio" name="pen_rad_${index}" value="${match.away}" onchange="handlePenInput(${index}, ${match.away})"> 
                                Fora
                            </label>
                        </div>
                    </div>
                </div>
            `;
            roundContainer.innerHTML += html;
        });
        // Adiciona o último grid
        if (roundContainer) container.appendChild(roundContainer);

        // Restaurar
        if (preserveValues) {
            for (let id in savedScores) {
                const el = document.getElementById(id);
                if (el) el.value = savedScores[id];
            }
            for (let idx in savedPens) {
                const val = savedPens[idx];
                const radios = document.getElementsByName(`pen_rad_${idx}`);
                radios.forEach(r => { if(r.value == val) r.checked = true; });
                handleScoreInput(idx);
                schedule[idx].penWinner = parseInt(val);
            }
        }
    }

    function handleScoreInput(index) {
        const hInput = document.getElementById(`m${index}_h`);
        const aInput = document.getElementById(`m${index}_a`);
        const penArea = document.getElementById(`pen-area-${index}`);
        
        const scoreH = hInput.value;
        const scoreA = aInput.value;

        if (scoreH !== '' && scoreA !== '' && scoreH === scoreA) {
            penArea.classList.add('active');
        } else {
            penArea.classList.remove('active');
            schedule[index].penWinner = null;
            const radios = document.getElementsByName(`pen_rad_${index}`);
            radios.forEach(r => r.checked = false);
        }
        calculateTable();
    }

    function handlePenInput(index, winnerId) {
        schedule[index].penWinner = winnerId;
        calculateTable();
    }

    function calculateTable() {
        // Reset Stats
        let stats = players.map(p => ({
            ...p, pts: 0, j: 0, v: 0, d: 0, gp: 0, gc: 0, sg: 0
        }));

        schedule.forEach((match, index) => {
            const hInput = document.getElementById(`m${index}_h`);
            const aInput = document.getElementById(`m${index}_a`);

            if (hInput && aInput && hInput.value !== '' && aInput.value !== '') {
                const gh = parseInt(hInput.value);
                const ga = parseInt(aInput.value);

                const pHome = stats[match.home];
                const pAway = stats[match.away];

                pHome.j++; pAway.j++;
                pHome.gp += gh; pHome.gc += ga;
                pAway.gp += ga; pAway.gc += gh;

                let winner = null;

                if (gh > ga) winner = match.home;
                else if (ga > gh) winner = match.away;
                else if (match.penWinner !== null) winner = match.penWinner;

                if (winner !== null) {
                    if (winner === match.home) {
                        pHome.v++; pHome.pts += 3;
                        pAway.d++;
                    } else {
                        pAway.v++; pAway.pts += 3;
                        pHome.d++;
                    }
                }
            }
        });

        stats.forEach(p => p.sg = p.gp - p.gc);

        stats.sort((a, b) => {
            if (b.pts !== a.pts) return b.pts - a.pts;
            if (b.v !== a.v) return b.v - a.v;
            if (b.sg !== a.sg) return b.sg - a.sg;
            return b.gp - a.gp;
        });

        const tbody = document.getElementById('standings-body');
        tbody.innerHTML = '';
        stats.forEach((p, index) => {
            const row = `
                <tr>
                    <td>${index + 1}º</td>
                    <td style="text-align:left; padding-left:10px;">${p.name}</td>
                    <td><strong>${p.pts}</strong></td>
                    <td>${p.j}</td>
                    <td>${p.v}</td>
                    <td>${p.d}</td>
                    <td>${p.sg}</td>
                    <td>${p.gp}</td>
                </tr>
            `;
            tbody.innerHTML += row;
        });
    }

    window.onload = init;
</script>

</body>
</html>